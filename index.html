<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ManuOS Player</title>
  <style>
    html,body { margin:0; height:100%; background:#000; }
    .wrap { position:fixed; inset:0; display:flex; }
    iframe { border:0; width:100%; height:100%; }
  </style>
</head>
<body>
  <div class="wrap" id="root"></div>

  <script>
    // Lire ?v=VIDEO_ID&t=START
    const p = new URLSearchParams(location.search);
    const v = (p.get("v") || "").trim();
    const t = Math.max(0, parseInt(p.get("t") || "0", 10) || 0);

    const root = document.getElementById("root");

    function renderError(msg){
      root.innerHTML = `<div style="color:#fff;font-family:system-ui;padding:16px">${msg}</div>`;
    }

    // Validation simple (Ã©vite les trucs bizarres)
    if (!/^[a-zA-Z0-9_-]{6,}$/.test(v)) {
      renderError("ID YouTube invalide.");
    } else {
      const qs = new URLSearchParams({
        autoplay: "1",
        rel: "0",
        modestbranding: "1",
        playsinline: "1"
      });
      if (t > 0) qs.set("start", String(t));

      // IMPORTANT : nocookie pour limiter les cookies
      const src = `https://www.youtube-nocookie.com/embed/${encodeURIComponent(v)}?${qs.toString()}`;

      const iframe = document.createElement("iframe");
      iframe.src = src;
      iframe.allow = "accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share";
      iframe.allowFullscreen = true;

      root.appendChild(iframe);
    }
  </script>
</body>
</html>
